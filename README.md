# Time-based one-time password
A simple CLI implementation of a time-based one-time password generator (TOTP) in C.

## Instructions

Works on Ubuntu and WSL2 with Ubuntu. You might have to adjust the Makefile if you have a different OS.

First install gcc, make, openssl and libssl:

`sudo apt update`

`sudo apt install gcc make openssl liibssl-dev`

Then create a `.env` file and add your base32 secret code as shown in the `.env.sample`.

Compile the project by running the `make` command in your terminal.

Run the program `./bin/totp`.
You should see an output like this:

```
Your OTP is: 123456
```

In case you want to test the accuracy of the output, you can use the same base32 code in any TOTP app (i.e. Google's Authenticator, Open Authenticator, etc.).

## How it works

TOTP leverages a simple set of operations that, given a secret code, allow to deterministically generate a simple-to-use **6 digit long** password that has a validity of **30 seconds**. TOTP is widely used for 2FA (Two-factor authentication) and is a quite robust protection from unauthorized access in case an account's regular password is compromised.

The algorithm for TOTP is defined in the **RFC 6238** standard. It all starts from a base32-encoded secret key. This key is generated by the service provider that enables **2FA protection**. It has to be securely stored by both the user (client) and the service provider (server), since anyone who has access to the secret can effortlessly generate a valid TOTP.

Base32 encodes information using 32 alphanumeric characters. There are different standards defining how the 32 digits should be represented, howewer TOTP uses the **RFC 4648** convention, which employs the following symbols:
```
A B C D E F G H I J K L M N O P Q R S T U V W S Y Z 2 3 4 5 6 7
```
Given a base32 secret, the first step involves decoding it into bytes.

```
Base32:     ORUGS43JONQWI5LNNV4XMYLM
Hex bytes:  74 68 69 73 69 73 61 64 75 6d 6d 79 76 61 6c
```
Next we need to take the unix epoch timestamp value of seconds and divide it by 30, which is our one-time password durations in seconds. 

```
1742747750 / 30
```
and encode it into an array of 8 bytes.